{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "bBPF",
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#invalid"
    },
    {
      "include": "#qualifiers"
    },
    {
      "include": "#keywords"
    },
    {
      "include": "#logical-operators"
    },
    {
      "include": "#bitwise-operators"
    },
    {
      "include": "#comparison-operators"
    },
    {
      "include": "#arithmetic-operators"
    },
    {
      "include": "#structure"
    },
    {
      "include": "#special-values"
    },
    {
      "include": "#numeric-values"
    }
  ],
  "repository": {
    "qualifiers": {
      "patterns": [
        {
          "name": "keyword.control.bpf.type",
          "match": "host|net|portrange|port|proto|protochain"
        },
        {
          "name": "keyword.control.bpf.dir",
          "match": "src|dst|src and dst|src or dst"
        },
        {
          "name": "keyword.control.bpf.proto",
          "match": "ether|fddi|tr|wlan|ip|ip6|arp|rarp|decnet|tcp|udp"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.bpf.length",
          "match": "length|len"
        },
        {
          "name": "keyword.control.bpf.length",
          "match": "(greater|less) (\\d+|0x[a-zA-Z0-9]{2}|0x[a-zA-Z0-9]{4})",
          "captures": {
            "1": {
              "name": "keyword.control.bpf.length"
            },
            "2": {
              "name": "constant.numeric.bpf"
            }
          }
        },
        {
          "name": "keyword.control.bpf",
          "match": "gateway|broadcast"
        }
      ]
    },
    "logical-operators": {
      "patterns": [
        {
          "name": "keyword.operator.logical.bpf",
          "match": "not|!|and|&&|or|\\|\\|"
        }
      ]
    },
    "comparison-operators": {
      "patterns": [
        {
          "name": "keyword.operator.comparison.bpf",
          "match": "!=|=|>|>=|<|<="
        }
      ]
    },
    "bitwise-operators": {
      "patterns": [
        {
          "name": "keyword.operator.bitwise.bpf",
          "match": "&|\\||>>|<<"
        }
      ]
    },
    "arithmetic-operators": {
      "patterns": [
        {
          "name": "keyword.operator.arithmetic.bpf",
          "match": "\\+|\\-|\\*|/"
        }
      ]
    },
    "structure": {
      "patterns": [
        {
          "name": "meta.structure.bpf.slice",
          "match": "([A-z0-9]+)\\[([^:\\]]*):?([^\\]])?\\]",
          "captures": {
            "2": {
              "name": "meta.structure.bpf.slice.expr"
            },
            "3": {
              "name": "meta.structure.bpf.slice.length"
            }
          }
        },
        {
          "name": "meta.structure.bpf.test",
          "begin": "\\(\\(\\(",
          "end": "\\)\\)\\)"
        }
      ]
    },
    "special-values": {
      "patterns": [
        {
          "name": "constant.bpf.addr.ip",
          "match": "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}"
        },
        {
          "name": "constant.bpf.addr.mac",
          "match": "([a-fA-F0-9]{2}:){5}[a-fA-F0-9]{2}"
        }
      ]
    },
    "numeric-values": {
      "patterns": [
        {
          "name": "constant.numeric.hex.bpf",
          "match": "0x[a-fA-F0-9]{2}|0x[a-fA-F0-9]{4}"
        },
        {
          "name": "constant.numeric.dec.bpf",
          "match": "\\d+"
        }
      ]
    },
    "invalid": {
      "patterns": [
        {
          "name": "invalid.illegal.bpf",
          "match": "[$@#`~\\\\{}\\.]"
        },
        {
          "name": "invalid.illegal.bpf",
          "match": "//+"
        }
      ]
    },
    "comments": {
      "patterns": [
        {
          "match": "(//) .*$",
          "name": "comment.line.bpf",
          "captures": {
            "1": {
              "name": "comment.line.double-dash.bpf"
            }
          }
        },
        {
          "begin": "/\\*",
          "end": "\\*/",
          "name": "comment.block"
        }
      ]
    }
  },
  "scopeName": "source.bbpf"
}